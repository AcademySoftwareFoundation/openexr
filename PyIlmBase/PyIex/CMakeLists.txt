
ADD_LIBRARY ( PyIex ${LIB_TYPE} PyIex.cpp)

target_compile_definitions( PyIex PRIVATE PYIEX_BUILD )

TARGET_INCLUDE_DIRECTORIES ( PyIex 
    PRIVATE ${CMAKE_INSTALL_PREFIX}/include/OpenEXR
    ${PYTHON_INCLUDE_PATH}
    ${Boost_INCLUDE_DIRS})

TARGET_LINK_LIBRARIES ( PyIex
	PUBLIC  IlmBase::Iex
	PRIVATE ${PYTHON_LIBRARIES}
	PRIVATE ${Boost_LIBRARIES}
)

INSTALL ( TARGETS PyIex
	DESTINATION
	lib
)

INSTALL ( 
  FILES 
    PyIex.h
    PyIexExport.h
    PyIexTypeTranslator.h

  DESTINATION
    include/OpenEXR
)


ADD_LIBRARY ( iexmodule ${LIB_TYPE}
	iexmodule.cpp
)

if (WIN32)
	SET_TARGET_PROPERTIES ( iexmodule
		PROPERTIES 
			PREFIX ""
			OUTPUT_NAME "iex" 
			SUFFIX ".pyd"
	)
else()
	SET_TARGET_PROPERTIES ( iexmodule
		PROPERTIES PREFIX "" SUFFIX ".so" BUILD_WITH_INSTALL_RPATH ON
	)
endif()

TARGET_LINK_LIBRARIES ( iexmodule
	PyIex
    IlmBase::Iex
	${PYTHON_LIBRARIES}
	${Boost_LIBRARIES}
)

TARGET_INCLUDE_DIRECTORIES ( iexmodule 
    PRIVATE ${CMAKE_INSTALL_PREFIX}/include/OpenEXR
    ${PYTHON_INCLUDE_PATH}
    ${Boost_INCLUDE_DIRS})

INSTALL ( TARGETS iexmodule
	DESTINATION lib/python${PYTHON_VERSION_MAJOR}.${PYTHON_VERSION_MINOR}/site-packages
)

